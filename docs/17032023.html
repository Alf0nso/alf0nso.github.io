<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>O Gafanhoto</title>
    
    <link rel="stylesheet" href="./css/gafanhoto.css" />
    <link rel="icon" type="image/png" href="./images/grasshopper.png">

    <!-- Any mathematical writing is dealt with mathJax -->
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/default.min.css">

    <!-- PDF reader -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.2.7/pdfobject.min.js" integrity="sha512-g16L6hyoieygYYZrtuzScNFXrrbJo/lj9+1AYsw+0CYYYZ6lx5J3x9Yyzsm+D37/7jMIGh0fDqdvyYkNWbuYuA==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

    <!-- p5.js for generative art and other pretty things -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.6.0/p5.js"></script>

  </head>
  <body>
    <div class="container">

      <div class="Header">
      </div>

      <div class="Menu">
	<a href="./index.html" class="logo">
	  <img src="./images/grassy.svg">
	</a>
	<a href="./index.html">  Home  </a>
	<hr>
        <a href="./about.html"> About </a>
	<hr>
	<a href="./archive.html"> Archive </a>
	<hr>
        <a href="./contact.html"> Contact </a>
	<hr>	
	<a href="./cv.html"> Vitae </a>
      </div>

      <div class="Main">
	<h1 id="para-laura">Para laura</h1>
<script>
let img; // variable to hold the image
let scaleFactor = 2; // Factor to scale the image and canvas size
let particleSize = 3; // Size of the dots (adjust to a larger value for fewer particles)
let particles = []; // Array to store particle objects

function preload() {
    // Load the image

    img = loadImage('/images/laururiruSinFShort.png');
}

function setup() {
    var canvas = createCanvas(img.width * scaleFactor, img.height * scaleFactor); // Create an enlarged canvas
    canvas.parent("laura");
    img.loadPixels(); // Load image pixels

    // Loop through the pixels of the image with increased increments
    for (let y = 0; y < img.height; y += particleSize) {
 for (let x = 0; x < img.width; x += particleSize) {
     let index = (x + y * img.width) * 4; // Get the pixel index

     // Extract color information (for grayscale images)
     let r = img.pixels[index];
     let g = img.pixels[index + 1];
     let b = img.pixels[index + 2];

     // Calculate brightness
     let brightness = (r + g + b) / 3;

     // Invert brightness for particle size
     let invertedBrightness = map(brightness, 135, 255, 350, 170);

     // Map inverted brightness to particle size
     let size = map(invertedBrightness, 0, 255, 1, particleSize * 1.5);

     // Create a particle object at (x, y) with the determined size and initial position
     let particle = {
  x: x * scaleFactor,
  y: y * scaleFactor,
  size: size,
  originalX: x * scaleFactor, // Store the original position
  originalY: y * scaleFactor,
     };

     // Add the particle to the particles array
     particles.push(particle);
 }
    }
}

function draw() {
    background(255); // Clear background

    // Display particles
    for (let i = 0; i < particles.length; i++) {
 let p = particles[i];
 fill(0); // Set dot color
 noStroke();
 ellipse(p.x, p.y, p.size, p.size); // Draw dot at particle position

 // Calculate distance between particle and mouse
 let mouseDistX = mouseX - p.x;
 let mouseDistY = mouseY - p.y;
 let distance = dist(mouseX, mouseY, p.x, p.y);

 // If the particle is close to the mouse, move away from it (with reduced movement)
 if (distance < 30) {
     p.x -= 2 * (mouseDistX / distance); // Reduced movement
     p.y -= 2 * (mouseDistY / distance); // Reduced movement
 } else {
     // Move back to original position if the mouse is not nearby (with reduced movement)
     let returnDistX = p.originalX - p.x;
     let returnDistY = p.originalY - p.y;
     p.x += returnDistX * 0.05; // Adjusted return speed (reduced movement)
     p.y += returnDistY * 0.05; // Adjusted return speed (reduced movement)
 }
    }
}
</script>

<div id="laura"></div>

      </div>

      <div class="Notes">
      </div>

      <div class="Footer">
	<div class="Footer-Text">
	  <a href="https://jaspervdj.be/hakyll/index.html">
	    <img src="./images/hakyll_logo.png">
	  </a>
	  <a rel="me" href="https://masto.pt/@gafanhoto">
	    <img src="./images/mastodon.svg">
	  </a>
	</div>
      </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js"></script>
    <script>hljs.highlightAll();</script>
  </body>
</html>
